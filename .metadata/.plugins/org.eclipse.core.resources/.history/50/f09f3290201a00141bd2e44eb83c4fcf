package com.demo.filestoragedemo;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.OutputStreamWriter;
import java.util.Scanner;

import android.app.Activity;
import android.os.Bundle;
import android.os.Environment;
import android.util.Log;
import android.widget.TextView;

public class FileStorageDemo extends Activity {
	
	private static final String FILE_NAME="myfile.txt";
	private static final String DIR = "YorkDir";
	private TextView msg;
	
	@Override
	protected void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		super.setContentView(R.layout.main);
		msg = (TextView) this.findViewById(R.id.msg);
		
		FileOutputStream outputStream = null;
		OutputStreamWriter writer = null;

		// use openFileOutput openFileInput
		// readWriteWithFile();

		// save file to sdcard

		//判断手机上是否有SDCard
		if(Environment.MEDIA_MOUNTED.equals(Environment.getExternalStorageState())){
			System.out.println("*****:" + Environment.getExternalStorageDirectory());
			System.out.println("*****:" + Environment.getExternalStorageDirectory() + File.separator+DIR + File.separator+ FILE_NAME);
			File file = new File(Environment.getExternalStorageDirectory() + File.separator+DIR + File.separator+ FILE_NAME);
			if(!file.exists()){
				file.mkdirs();
				System.out.println("---file exists:" + file.getParentFile().exists());
			}
			try {
				outputStream = new FileOutputStream(file);
				writer = new OutputStreamWriter(outputStream);
				writer.write("姓名：YorkYong");
				writer.write("年龄：20");
				writer.write("Support Email：YorkYong@gamil.com");
	
				
			} catch (Exception e) {
				Log.e("ERROR", e.getMessage());
			} finally{
				try {
					writer.flush();
					writer.close();
					outputStream.close();
				} catch (IOException e) {
					Log.e("ERROR", e.getMessage());
				}
			}
		}

//		
//
//		try {
//			outputStream = super.openFileOutput(FILE_NAME,
//					Activity.MODE_PRIVATE);
//			writer = new OutputStreamWriter(outputStream);
//
//			writer.write("姓名：YorkYong");
//			writer.write("年龄：20");
//			writer.write("Support Email：YorkYong@gamil.com");
//
//			writer.flush();
//			writer.close();
//
//		} catch (Exception e) {
//			Log.e("Error", e.getMessage());
//			e.printStackTrace();
//		}

	}
	
	private void readWriteWithFile() {
		// create and save file

		FileOutputStream outputStream = null;
		OutputStreamWriter writer = null;

		try {
			outputStream = super.openFileOutput(FILE_NAME,
					Activity.MODE_PRIVATE);
			writer = new OutputStreamWriter(outputStream);

			writer.write("姓名：YorkYong");
			writer.write("年龄：20");
			writer.write("Support Email：YorkYong@gamil.com");

			writer.flush();
			writer.close();

		} catch (Exception e) {
			Log.e("Error", e.getMessage());
			e.printStackTrace();
		}

		// read file content
		FileInputStream inputStream = null;
		Scanner scanner = null;
		try {
			inputStream = super.openFileInput(FILE_NAME);
			scanner = new Scanner(inputStream);

			while (scanner.hasNext()) {
				this.msg.append(scanner.next() + "\n");
			}
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
}
